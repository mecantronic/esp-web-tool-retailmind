<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <title>Instalador RetailMind</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="color-scheme" content="light dark" />
    <meta name="description" content="Herramienta de instalación y configuración para dispositivos RetailMind" />
    <link rel="icon" href="favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" href="styles.css" />
    <script type="module" src="https://unpkg.com/esp-web-tools@8.0.1/dist/web/install-button.js?module"></script>
  </head>
  <body>
    <div class="container">
      <img src="logo.png" alt="RetailMind Logo" class="logo" />
      <h1>Instalador de Firmware – RetailMind</h1>

      <!-- Instrucciones de instalación -->
      <section class="card instructions">
        <h2>Instrucciones</h2>
        <ol>
          <li>Conectá tu dispositivo <strong>ESP32</strong> por USB a la computadora.</li>
          <li>Asegurate de usar <strong>Google Chrome</strong> o <strong>Microsoft Edge</strong> (otros navegadores no son compatibles).</li>
          <li>Elegí la versión de firmware adecuada en el menú desplegable.</li>
          <li>Hacé clic en el botón <em>Connect</em>.</li>
          <li>Seleccioná el puerto USB del dispositivo cuando lo solicite el navegador.</li>
          <li>Esperá a que finalice el proceso sin desconectar el dispositivo.</li>
          <li>¡Listo! Tu dispositivo estará flasheado y listo para usar.</li>
        </ol>
      </section>

      <!-- Sección de selección de firmware -->
      <section class="firmware-section">
        <h2>Seleccioná versión del firmware</h2>
        <select id="board-select">
          <option value="manifest_esp32_tinypico_v1_1.json">Versión: 1.1 (retailmind-device)</option>
          <option value="manifest_esp32_tinypico_v1_0.json">Versión: 1.0 (retailmind-device)</option>
          <option value="manifest_esp32.json">Versión: 1.0 (ESP32 - test)</option>
        </select>

        <div id="version-description" class="version-box"></div>

        <div class="esp-web-install-button-row">
          <esp-web-install-button></esp-web-install-button>
          <button id="config-button" class="btn btn-secondary">CONFIGURACION</button>
        </div>
      </section>

      <!-- Modal de Configuración -->
      <div id="config-modal" class="modal">
        <div class="modal-content">
          <div class="modal-header">
            <h2>Modo Configuración</h2>
            <span class="close-modal">&times;</span>
          </div>
          <div class="modal-body">
            <div class="config-buttons">
              <button id="connect-serial" class="btn btn-primary">Conectar Puerto Serial</button>
              
              <div class="config-actions">
                <button id="activate-config" class="btn btn-success" disabled>Activar Modo Config</button>
                <button id="deactivate-config" class="btn btn-danger" disabled>Desactivar Modo Config</button>
                <button id="read-config" class="btn btn-info" disabled>Leer Configuración</button>
              </div>
              
              <div id="config-status" class="status-indicator">
                Estado: Esperando conexión
              </div>
              
              <!-- Formulario de configuración -->
              <div id="config-form" class="config-form">
                <h3>Configuración del Dispositivo</h3>
                <div class="form-group">
                  <label for="deviceId">ID del Dispositivo:</label>
                  <input type="text" id="deviceId" class="form-control" readonly>
                </div>
                <div class="form-group">
                  <label for="wifi-ssid">SSID WiFi:</label>
                  <input type="text" id="wifi-ssid" class="form-control" readonly>
                </div>
                <div class="form-group">
                  <label for="wifi-password">Contraseña WiFi:</label>
                  <input type="text" id="wifi-password" class="form-control" readonly>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Pie de página -->
      <footer class="footer">
        Desarrollado por <a href="https://devolut.tech" target="_blank" rel="noopener">Devolut</a> | 
        Basado en <a href="https://esphome.github.io/esp-web-tools/" target="_blank" rel="noopener">ESP Web Tools</a>
      </footer>
    </div>
    
    <script src="script.js"></script>
  </body>
</html>